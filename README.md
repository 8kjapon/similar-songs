# musim:『似ている』から始まる曲探し
[![Image from Gyazo](https://i.gyazo.com/79799672f852595a24a1177be4ac6a22.jpg)](https://gyazo.com/79799672f852595a24a1177be4ac6a22)

## 📄サービス概要
- 似てるジャンルや似てるメロディの楽曲を紹介する『音楽紹介サイト』になります。
- 実際にユーザーが似てると思う曲をデータベースに登録して紹介楽曲を増やせるようにすることで運営者だけでなくユーザーもサイトコンテンツを作っていくことに参加ができます。
- ただの音楽データベースではなく、似てる曲を探せることに特化したサービスになります。

**サービスURL**: https://musim.8kjapon.com/

## 🔧開発背景
私は自身の趣味として音楽鑑賞や作曲に取り組んできましたが、その中で『メロディが似ている曲』というモノが世の中には思いの外多く、その『似ている曲』経由で新しい楽曲やアーティストと出会うことが出来、知らない世界を知ることが出来た経験がありました。
そんな意外な音楽との出会いと楽しさをもっと多くの方に知ってもらいたいという気持ちから本サービスを開発することにしました。

## 🎯メインターゲット
音楽好きな方をターゲットとしていますが、その中でも『新しい音楽との出会いを常に求めている方』への需要を満たせるサービスを目指し制作しております。
また、似ている楽曲のカテゴリーをメロディの他にも『ジャンル・スタイル』、『サンプリング』と用意することで「同じような音楽スタイルの曲を探したい」、「この曲をサンプリング使用している楽曲を聴いてみたい」といったような明確な目的を持たれたユーザーへの需要も満たせるようになっています。

## ❓似ているの定義について
楽曲が似ていると判断出来る大雑把なカテゴライズとして『ジャンル』があります。
よく聞くものですと以下のようなものがあります。
- ロック
- バラード
- ヒップホップ
- オーケストラ

ただし、これらはあくまで大枠でしかなく、細分化されたサブジャンル等もあるものの「この曲と同じような曲が聞きたい！」という明確な目的のもとで楽曲探しをする際には意外と役にたたない場合があります。
そこでmusimの出番になります。

musimでは
- メロディが似ている
- ジャンル・スタイルが似ている
- サンプリングしているorされている

という定義でカテゴライズしており、「この曲に似ている(関係している)曲を探したい」という明確な目的を持たれたユーザーの需要を満たしやすい条件の元楽曲分けがされています。
また、各カテゴリーの定義についても楽曲登録ページにて以下のようなガイドラインを設置することで『どこを基準に判断するべきか』をユーザー側でも理解しやすいようになっています。
[![Image from Gyazo](https://i.gyazo.com/4a7d999883bdc842d70d640ca4113c64.jpg)](https://gyazo.com/4a7d999883bdc842d70d640ca4113c64)
このようなガイドラインを設けることで、カテゴリー内コンテンツのブレを抑えると共に、一見大雑把なカテゴリーに見える『ジャンル・スタイル』についても
- 楽曲内で使用されている楽器やエフェクトの使い方
- ボーカルの歌い方

など具体的な楽曲上の特徴を重視したガイドラインにすることで『明確な目的を持ったユーザー』への需要をクリア出来るようにしております。

## 🎵主要な機能
| 似ている楽曲の検索・閲覧機能 |
| :---: |
| [![Image from Gyazo](https://i.gyazo.com/8dd6202996660828bbfb4d3202d4b6bf.gif)](https://gyazo.com/8dd6202996660828bbfb4d3202d4b6bf) |
| 任意のワードから楽曲やアーティストを検索し、コンテンツを閲覧 |

| 自分が知っている似ている楽曲の登録機能 |
| :---: |
| [![Image from Gyazo](https://i.gyazo.com/b6d2c0b65cf93e2a9dac3d6342a488e2.gif)](https://gyazo.com/b6d2c0b65cf93e2a9dac3d6342a488e2) |
| 楽曲情報やYouTubeリンクなどを入力し、楽曲情報を登録<br>オートコンプリート機能やYouTube動画のプレイヤー自動表示機能なども実装 |

| 似ている楽曲への評価機能 |
| :---: |
| [![Image from Gyazo](https://i.gyazo.com/bb439ba8734c98b9e9a7046e2c55bb34.gif)](https://gyazo.com/bb439ba8734c98b9e9a7046e2c55bb34) |
| 「似ている！」や「良い！」と思える楽曲へ評価することが可能 |

| 閲覧数を参照にした人気楽曲の一覧機能 |
| :---: |
| [![Image from Gyazo](https://i.gyazo.com/17de2b889e790a033e98d49132379177.jpg)](https://gyazo.com/17de2b889e790a033e98d49132379177) |
| コンテンツの閲覧数をもとに人気のある曲を一覧で表示 |

# 🛠使用技術について
## 主要な使用技術
| カテゴリー | 内容 |
| --- | --- |
| バックエンド | Ruby(3.2.5), Ruby on Rails(7.0.8.4) |
| フロントエンド | Ruby on Rails, JavaScript |
| データベース | MySQL(8.0.39) |
| Webサーバー | Linux(Ubuntu), Nginx |
| メールサーバー | AWS(Amazon SES) |
| CI/CD | GitHub Actions |
| 開発・運用環境 | Docker, Docker Desktop |
| バージョン・コード管理 | Git, GitHub |

## その他技術等
| 技術 | 目的 |
| --- | --- |
| Stimulus-rails | オートコンプリート、コンテンツの非同期表示等 |
| Google Cloud | Googleログイン機能 |
| AdminLTE | 管理画面構築 |
| Bootstrap 5 | UIデザイン補助 |

## 技術選定について
### 【バックエンド】
スピード感のある開発、学習内容を活用し開発を行うという目的から、Ruby及びRuby on Railsを採用しました。
各バージョンについては開発開始段階で
- 安定したバージョン
- 情報量の多さ

などを元に選定いたしました。

### 【フロントエンド】
ベースとして使用しているRuby on Railsをいかしつつ、それだけでは表現しきれない描画機能や挙動をJavaScriptで実装する形で選定・使用しました。
JavaScriptに関してはStimulus等のライブラリも利用しております。

### 【データベース】
安定した挙動、これまでの使用・学習経験、情報の多さ等からMySQLを採用しました。
バージョンに関しても同様な観点からバージョン8系を選択しました。

### 【Webサーバー】
アプリケーションを動作させるサーバーには以前より個人利用しているVPSサーバー(Linux/Ubuntu)を利用し、Webサーバーとしての管理にはNginxを採用しております。
本アプリケーション開発以前はApacheでのWebサーバー運用をしておりましたが、複数サービス・アプリケーションの管理のしやすさからNginxへの移行を行いました。

### 【メールサーバー】
問い合わせ機能やパスワード再設定機能に必要なメールの送信機能の実装に伴い、AWSのAmazon SESを採用し、実装を行いました。
様々なメールサーバー構築サービスはございますが、AWSそのものの利用頻度や需要の高さから今回はこちらを選定しました。

### 【CI/CD】
アプリケーションのテスト及びデプロイの自動化においては、まず段階的に
- Rspecの導入
- デプロイ工程自動化のシェルスクリプト作成

などから行っておりましたが、より効率が良くプロジェクト管理で既に利用していたGitHubのActionsを採用し、テスト及びデプロイの自動化を行いました。

### 【開発・運用環境】
開発段階からDockerコンテナ上で開発を行っており、既に個人開発・運用していたアプリケーション等をサーバー上のDocker環境で運用していた為、本サービス及びアプリケーションもDockerを利用する形で開発を進めることにしました。
また、開発環境ではDocker Desktopも共に利用しております。

### 【バージョン・コード管理】
バージョンやコードの管理には以前より利用しており、情報の多さや需要の高いGitとGitHubを採用した開発を行いました。
開発環境ではデスクトップ上で動作するGitKraken等も部分的に利用しましたが、基本的にGitとGitHubのみで管理されております。

## 実装機能詳細
- ユーザー機能
  - ユーザー登録機能
  - マイページ表示
  - ユーザー情報の変更機能
  - 外部SNSによるログイン機能
- 楽曲関連 
  - 楽曲登録・編集機能
  - 評価機能(Ajaxによる非同期更新)
  - 検索機能
  - 楽曲登録及び検索時のオートコンプリート機能
  - 楽曲登録フォームのマルチステップ化
  - 楽曲ページの閲覧数記録とそこから参照した人気曲ページの表示
- その他
  - ページのSNS共有機能
  - ページネーション機能
  - i18nへの対応
  - 問い合わせ機能
  - パスワードを忘れたユーザー向けのパスワードリセット機能
  - 問い合わせ、パスワードリセット時のメール送信
- 管理者用機能
  - 楽曲・アーティスト情報の管理
  - ユーザーの管理
  - 問い合わせ情報の管理

(管理画面一部)
[![Image from Gyazo](https://i.gyazo.com/8c0baa52ace77c583e94f56525d6d586.jpg)](https://gyazo.com/8c0baa52ace77c583e94f56525d6d586)

## ER図
[![Image from Gyazo](https://i.gyazo.com/3a037ddc3ef6b985dd00f5a51a2b91e7.png)](https://gyazo.com/3a037ddc3ef6b985dd00f5a51a2b91e7)

## 画面遷移図 (開発前段階)
開発前段階で以下のような画面遷移を想定し、画面遷移図の作成を行いました。
[画面遷移図 - figma](https://www.figma.com/design/3bjsOa8nyyGksM4QTVnIXz/240930_similar-songs?node-id=1-2&t=I00VkG1r1UnokXIS-1)

設計段階で**未ログイン時のコンテンツ**と**ログイン状態時のコンテンツ**を分けて作成し、それぞれの状況に必要な情報やUIの選定を行っています。
UIデザインに関しては、私自身が趣味としてこれまで多くの音楽系サービスに触れてきた中で感じた以下のポイント
- 複雑すぎない
- 情報が多すぎない
- シンプル過ぎない
- 欲しい情報にたどり着きやすい

これらを意識し、Bootstrapをベースとしてデザイン出来るよう作成を進めました。
### 『複雑すぎない』『情報が多すぎない』
昨今多機能なWebサービスやアプリケーションが増える中、情報が多すぎるあまりユーザーが理解しにくい或いは理解までに時間を要するものが多い印象がありましたので『ふらっと立ち寄ってなんとなくでも利用できる』ようなデザインを目標としました。

### 『シンプル過ぎない』
わかりやすいデザインとはいえ、あまりにも簡素すぎてしまうとサービスの印象が薄れてしまう為、Bootstrap等を活用したモダンなデザインにしつつ、カラーリング等を統一することでサービスの印象を持たせられるようデザインを行いました。
サービスのメインカラーリングには様々な音楽シーンで使用されている『Nord Lead』というシンセサイザー(ヘッダー画像にも利用)をモデルとした赤と黒をベースにしたカラーリングを使用しています。

### 『欲しい情報にたどり着きやすい』
アプリケーションを利用する際に「このページに行きたいのにどこから見れるのかわからない」といったような混乱を避ける為、直接的なアクセスが出来るようなデザイン・画面設計を行っており、
- 曲名を押せばその楽曲ページが表示される
- マイページに行けばユーザーに関する情報が閲覧できる

といったような欲しいものを短いルートで得られるような設計を意識して行いました。
特に『短いルートでアクセス出来る』という点においてはスマホアプリ等のデザインでそれらの傾向が強い印象がありましたので、既存のスマホアプリ等を参考に作成を進めました。